document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelector(".toc-container");if(!t)return;let e;function o(t){t.preventDefault();const e=this.getAttribute("href").slice(1),o=document.getElementById(e);o&&(t.stopPropagation(),window.scrollTo({top:o.offsetTop-100,behavior:"smooth"}),history.pushState?history.pushState(null,null,`#${e}`):location.hash=`#${e}`)}function n(){const e=window.scrollY+150,o=Array.from(document.querySelectorAll(".article-content h2, .article-content h3, .article-content h4"));if(0===o.length)return;let n=null,c=null;for(let t=0;t<o.length;t++){const r=o[t],s=o[t+1],i=r.offsetTop,l=s?s.offsetTop:document.body.scrollHeight;if(e>=i&&e<l){c=n,n=r;break}}if(!n&&o.length>0){for(const t of o)if(t.offsetTop>e){n=t;break}n||(n=o[o.length-1])}!function(e,o,n){if(!e)return;const c=document.querySelectorAll(".toc-href"),r=document.querySelector(".toc-marker");c.forEach((t=>{t.classList.remove("toc-reading")}));const s=document.querySelector(`.toc-href[href="#${e.id}"]`);if(!s)return;if(s.classList.add("toc-reading"),function(t,e,o){const n=Array.from(e),c=n.indexOf(t);n.forEach(((t,e)=>{const r=t.getAttribute("href").slice(1),s=document.getElementById(r);if(s)if(e<c){t.classList.add("toc-already-read");const e=t.querySelector("circle");e&&e.setAttribute("stroke-dashoffset","0")}else if(e===c){t.classList.add("toc-already-read");const c=document.getElementById(n[e+1]?.getAttribute("href").slice(1));if(c){const e=Math.min(100,(o-s.offsetTop)/(c.offsetTop-s.offsetTop)*100),n=t.querySelector("circle");n&&n.setAttribute("stroke-dashoffset",Math.round(100-e))}}else t.classList.remove("toc-already-read")}))}(s,c,n),r){const t=s.offsetTop;r.style.transform=`translateY(${t}px)`}!function(e,o){const n=e.parentElement,c=t.getBoundingClientRect(),r=n.getBoundingClientRect(),s=o&&o.offsetTop>n.offsetTop;if(r.top<c.top||r.bottom>c.bottom){const e=s?.7*t.clientHeight:.3*t.clientHeight;t.scrollTo({top:n.offsetTop-e,behavior:"smooth"})}}(s,o)}(n,c,e)}document.querySelectorAll(".article-content h2, .article-content h3, .article-content h4").forEach(((t,e)=>{if(!t.id){const o=t.textContent.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-");t.id=`heading-${o}-${e}`}t.classList.add("scroll-target")})),function(){const t=document.querySelector(".toc-content");if(!t)return;const e=document.createElement("div");e.className="toc-marker",t.appendChild(e)}(),function(){const e=t.querySelectorAll(".toc-list-item a");if(0===e.length)return;e.forEach((t=>{t.classList.remove("toc-link"),t.classList.add("toc-href"),t.insertAdjacentHTML("afterbegin",'\n        <svg viewBox="0 0 24 24" width="18" height="18" xmlns="http://www.w3.org/2000/svg">\n            <line x1="0" y1="12" x2="8" y2="12" class="toc-line"></line>\n            <circle cx="14" cy="12" r="4" class="toc-dot"></circle>\n        </svg>\n        '),t.addEventListener("click",o)})),function(){const e=t.querySelectorAll("a.toc-href");Array.from(e).map((t=>{const e=t.getAttribute("href").slice(1);return{id:e,header:document.getElementById(e),link:t}})).filter((t=>t.header))}()}(),window.addEventListener("scroll",(()=>{e&&window.cancelAnimationFrame(e),e=requestAnimationFrame((()=>{n()}))}),{passive:!0}),n()}));