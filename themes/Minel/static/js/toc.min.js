(()=>{const e=(e,t)=>{"function"==typeof window.debugLog&&window.debugLog(e,t)};e("TOC","TOC başlatılıyor...");const t=document.querySelector(".toc-container");if(!t)return void e("TOC","TOC container bulunamadı");const o=t.querySelectorAll("a.toc-href");if(e("TOC",`TOC linkleri: ${o.length}`),!o.length)return void e("TOC","TOC linkleri bulunamadı");o.forEach(((t,o)=>{e("TOC",`Link ${o}: ${t.href} - ${t.textContent}`),t.insertAdjacentHTML("afterbegin",'\n    <svg viewBox="0 0 24 24" class="toc-icon">\n        <circle cx="4" cy="12" r="2" class="toc-dot"/>\n        <line x1="6" y1="12" x2="18" y2="12" class="toc-line"/>\n    </svg>\n  ')}));const n=Array.from(o).map((t=>{const o=t.getAttribute("href").slice(1),n=document.getElementById(o);return e("TOC",`Başlık ${o}: ${n?"bulundu":"bulunamadı"}`),{id:o,header:n,link:t}})).filter((e=>e.header));e("TOC",`Eşleşen başlık sayısı: ${n.length}`);const l=()=>{const o=window.scrollY+200;let l=null,a=null;for(const e of n){if(!(e.header.offsetTop<=o))break;a=l,l=e}l?(e("TOC",`Aktif başlık: ${l.id}`),n.forEach((({header:e,link:r},i)=>{if(e.offsetTop<o){r.classList.add("toc-already-read");const t=n[i+1]?.header,l=t?Math.min(100,(o-e.offsetTop)/(t.offsetTop-e.offsetTop)*100):100,a=r.querySelector("circle");a&&a.setAttribute("stroke-dashoffset",Math.round(100-l))}else r.classList.remove("toc-already-read");if(e===l.header){r.classList.add("toc-reading");const e=r.parentElement,o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=a&&a.header.offsetTop>l.header.offsetTop;if(n.top<o.top||n.bottom>o.bottom){const o=i?.7*t.clientHeight:.3*t.clientHeight;t.scrollTo({top:e.offsetTop-o,behavior:"smooth"})}}else r.classList.remove("toc-reading")}))):e("TOC","Aktif başlık bulunamadı")};let a;window.addEventListener("scroll",(()=>{a&&window.cancelAnimationFrame(a),a=requestAnimationFrame((()=>{e("TOC",`Scroll pozisyonu: ${window.scrollY}`),l()}))}),{passive:!0}),o.forEach((t=>{t.addEventListener("click",(o=>{o.preventDefault();const n=t.getAttribute("href").slice(1),l=document.getElementById(n);l&&(e("TOC",`Tıklanan başlık: ${n}`),o.stopPropagation(),window.scrollTo({top:l.offsetTop-100,behavior:"smooth"}),history.pushState?history.pushState(null,null,`#${n}`):location.hash=`#${n}`)}))})),e("TOC","TOC ilk güncelleme yapılıyor..."),l()})();